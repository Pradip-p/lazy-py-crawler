{% extends "base.html" %}

{% block title %}Manage Blog | Admin{% endblock %}

{% block content %}
<section class="section" style="padding-top: 2rem; background: #f8f9fa; min-height: 80vh;">
    <div class="container">
        <!-- Header -->
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
            <div>
                <h1 class="section-title" style="margin-bottom: 0.5rem; text-align: left;">Blog Management</h1>
                <p style="color: var(--text-muted);">Create, edit, and manage your content.</p>
            </div>
            <a href="/admin/blog/new" class="btn-primary" style="text-decoration: none; padding: 0.75rem 1.5rem; border-radius: 8px;">
                + Create Post
            </a>
        </div>

        <!-- Stats (Optional Placeholder) -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
            <div style="background: white; padding: 1.5rem; border-radius: 8px; border: 1px solid var(--border-color); box-shadow: 0 2px 4px rgba(0,0,0,0.02);">
                <div style="color: var(--text-muted); font-size: 0.85rem; font-weight: 600; text-transform: uppercase;">Total Posts</div>
                <div style="font-size: 2rem; font-weight: 800; color: var(--slack-purple);">{{ posts|length }}</div>
            </div>
             <!-- Calculate published count in template logic is hard without backend support, skipping for now or using JS -->
        </div>

        <!-- Table Card -->
        <div style="background: white; border: 1px solid var(--border-color); border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.02); overflow: hidden;">
            <table style="width: 100%; border-collapse: collapse; text-align: left;">
                <thead>
                    <tr style="background: #fcfcfc; border-bottom: 1px solid var(--border-color);">
                        <th style="padding: 1rem 1.5rem; font-weight: 600; color: var(--text-muted); font-size: 0.85rem; text-transform: uppercase;">Post Details</th>
                        <th style="padding: 1rem 1.5rem; font-weight: 600; color: var(--text-muted); font-size: 0.85rem; text-transform: uppercase;">Status</th>
                        <th style="padding: 1rem 1.5rem; font-weight: 600; color: var(--text-muted); font-size: 0.85rem; text-transform: uppercase;">Date</th>
                        <th style="padding: 1rem 1.5rem; font-weight: 600; color: var(--text-muted); font-size: 0.85rem; text-transform: uppercase; text-align: right;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for post in posts %}
                    <tr style="border-bottom: 1px solid #f0f0f0; transition: background 0.1s;">
                        <td style="padding: 1.25rem 1.5rem;">
                            <div style="font-weight: 600; font-size: 1rem; color: var(--text-dark); margin-bottom: 0.25rem;">{{ post.title }}</div>
                            <div style="font-size: 0.85rem; color: var(--text-muted); font-family: monospace;">/blog/{{ post.slug }}</div>
                        </td>
                        <td style="padding: 1.25rem 1.5rem;">
                            {% if post.published %}
                            <span style="background: #e6fffa; color: #2eb67d; padding: 0.25rem 0.75rem; border-radius: 99px; font-size: 0.75rem; font-weight: 700; letter-spacing: 0.5px;">PUBLISHED</span>
                            {% else %}
                            <span style="background: #fff5f5; color: #e01e5a; padding: 0.25rem 0.75rem; border-radius: 99px; font-size: 0.75rem; font-weight: 700; letter-spacing: 0.5px;">DRAFT</span>
                            {% endif %}
                        </td>
                        <td style="padding: 1.25rem 1.5rem; color: var(--text-muted); font-size: 0.9rem;">
                            {{ post.created_at.strftime('%b %d, %Y') }}
                        </td>
                        <td style="padding: 1.25rem 1.5rem; text-align: right;">
                            <div style="display: flex; gap: 0.5rem; justify-content: flex-end;">
                                <a href="/blog/{{ post.slug }}" target="_blank" style="padding: 0.4rem 0.8rem; border-radius: 4px; color: var(--text-muted); text-decoration: none; font-size: 0.85rem; font-weight: 600; border: 1px solid #eee;">View</a>
                                <a href="/admin/blog/{{ post.id }}/edit" style="padding: 0.4rem 0.8rem; border-radius: 4px; background: var(--slack-purple); color: white; text-decoration: none; font-size: 0.85rem; font-weight: 600;">Edit</a>
                                <form action="/admin/blog/{{ post.id }}/delete" method="POST" style="display: inline;" onsubmit="return confirm('Delete this post permanently?');">
                                    <button type="submit" style="padding: 0.4rem 0.8rem; border-radius: 4px; background: #fff5f5; color: #e01e5a; border: 1px solid #ffe3e3; font-size: 0.85rem; font-weight: 600; cursor: pointer;">Delete</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="4" style="padding: 5rem; text-align: center;">
                            <div style="margin-bottom: 1rem; font-size: 3rem;">üìù</div>
                            <h3 style="margin-bottom: 0.5rem; color: var(--text-dark);">No posts yet</h3>
                            <p style="color: var(--text-muted); margin-bottom: 1.5rem;">Start sharing your thoughts with the world.</p>
                            <a href="/admin/blog/new" class="btn-primary" style="text-decoration: none;">Create First Post</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</section>
{% endblock %}
